MODEL_NAME=foo
VALIDATIONLIST=eval
VALIDATIONLOG=plot/$(MODEL_NAME)-fast$(VALIDATIONLIST).log
MAXCER=1

FASTEVAL_FILES=$(sort $(wildcard data/$(MODEL_NAME)/tessdata_fast/*_[0-$(MAXCER)].[0-9]*.traineddata))
VALIDATIONLOG_FILES=$(subst tessdata_fast,tessdata_fast,$(patsubst %.traineddata,%.$(VALIDATIONLIST).log,$(FASTEVAL_FILES)))

fasteval: $(VALIDATIONLOG)
.PHONY: fasteval $(VALIDATIONLOG)

$(VALIDATIONLOG): $(VALIDATIONLOG_FILES)
	for i in $^; do \
		echo Filename : "$$i";echo;cat "$$i"; \
	done > $@
 
$(VALIDATIONLOG_FILES): %.$(VALIDATIONLIST).log: %.traineddata
	echo "***** $< ****"
	OMP_THREAD_LIMIT=1 lstmeval  \
    --verbosity=0 \
    --model $< \
    --eval_listfile data/$(MODEL_NAME)/list.${VALIDATIONLIST}    > $@ 2>&1
